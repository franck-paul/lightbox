"use strict";(()=>{const t=jQuery;if(/^1\.(0|1)\./.test(t.fn.jquery)||/^1\.2\.(0|1|2|3|4|5)/.test(t.fn.jquery))throw`Modal requieres jQuery v1.2.6 or later. You are using v${t.fn.jquery}`;t.modal=function(e,i){return this.params=t.extend(this.params,i),this.build(e)},t.modal.version="1.0",t.modal.prototype={params:{width:null,height:null,speed:300,opacity:.9,loader_img:"loader.gif",loader_txt:"loading...",close_img:"close.png",close_txt:"close",on_close(){}},ctrl:{box:t(),loader:t(),overlay:t('<div id="jq-modal-overlay"></div>'),hidden:t()},build(e){this.ctrl.loader=t(`<div class="jq-modal-load"><img src="${this.params.loader_img}" alt="${this.params.loader_txt}"></div>`),this.addOverlay();const i=this.getBoxSize(this.ctrl.loading);return this.ctrl.box=this.getBox(this.ctrl.loading,{top:Math.round(t(window).height()/2+t(window).scrollTop()-i.h/2),left:Math.round(t(window).width()/2+t(window).scrollLeft()-i.w/2),visibility:"hidden"}),this.ctrl.overlay.after(this.ctrl.box),null!=e&&(this.updateBox(e),this.data=e),this},updateBox(e,i){this.hideCloser(),i="function"==typeof i?i:()=>{};const o=t("div.jq-modal-content",this.ctrl.box);o.empty().append(this.ctrl.loader);const s=this.getBoxSize(e,this.params.width,this.params.height),a=Math.round(t(window).height()/2+t(window).scrollTop()-s.h/2),l=Math.round(t(window).width()/2+t(window).scrollLeft()-s.w/2);this.ctrl.box.css("visibility","visible").animate({top:a<0?0:a,left:l<0?0:l,width:s.w,height:s.h},this.params.speed,(()=>{this.setContentSize(o,this.params.width,this.params.height),o.empty().append(e).css("opacity",0).fadeTo(this.params.speed,1,(()=>{i.call(this,o)})),this.showCloser()}))},getBox(e,i,o,s){const a=t('<div class="jq-modal"><div class="jq-modal-container"><div class="jq-modal-content"></div></div></div>').css(t.extend({position:"absolute",top:0,left:0,zIndex:100},i));return null!=e&&t("div.jq-modal-content",a).append(e),this.setContentSize(t("div.jq-modal-content",a),o,s),a},getBoxSize(t,e,i){let o=this.getBox(t,{visibility:"hidden"},e,i);this.ctrl.overlay.after(o);const s={w:o.width(),h:o.height()};return o.remove(),o=null,s},setContentSize(t,e,i){t.css({width:e>0?e:"auto",height:i>0?i:"auto"})},showCloser(){if(t("div.jq-modal-closer",this.ctrl.box).length>0)return void t("div.jq-modal-closer",this.ctrl.box).show();t("div.jq-modal-container",this.ctrl.box).append(`<div class="jq-modal-closer"><a href="#">${this.params.close_txt}</a></div>`);const e=t("div.jq-modal-closer a",this.ctrl.box);e.css({background:`transparent url(${this.params.close_img}) no-repeat`}).click((()=>(this.removeOverlay(),!1))),document.all&&(e[0].runtimeStyle.filter=`progid:DXImageTransform.Microsoft.AlphaImageLoader(src="${this.params.close_img}", sizingMethod="crop")`,e[0].runtimeStyle.backgroundImage="none")},hideCloser(){t("div.jq-modal-closer",this.ctrl.box).hide()},addOverlay(){document.all&&(this.ctrl.hidden=t("select:visible, object:visible, embed:visible").css("visibility","hidden")),this.ctrl.overlay.css({backgroundColor:"#000",position:"absolute",top:0,left:0,zIndex:90,opacity:this.params.opacity}).appendTo("body").dblclick((()=>{this.removeOverlay()})),this.resizeOverlay({data:this.ctrl}),t(window).on("resize.modal",this.ctrl,this.resizeOverlay),t(document).on("keypress.modal",this,this.keyRemove)},resizeOverlay(e){if(e.data.overlay.css({width:t(window).width(),height:t(document).height()}),e.data.box.parents("body").length>0){const i=Math.round(t(window).height()/2+t(window).scrollTop()-e.data.box.height()/2),o=Math.round(t(window).width()/2+t(window).scrollLeft()-e.data.box.width()/2);e.data.box.css({top:i<0?0:i,left:o<0?0:o})}},keyRemove:t=>(27==t.keyCode&&t.data.removeOverlay(),!0),removeOverlay(){t(window).off("resize.modal"),t(document).off("keypress"),this.params.on_close.apply(this),this.ctrl.overlay.remove(),this.ctrl.hidden.css("visibility","visible"),this.ctrl.box.remove(),this.ctrl.box=t()}}})(),(()=>{const t=jQuery;t.fn.modalImages=function(e){e=t.extend(this.params,e);const i=[];return this.each((function(){if(""==t(this).attr("href")||null==t(this).attr("href")||"#"==t(this).attr("href"))return!1;const o=i.length;return i.push(t(this)),t(this).click((()=>(new t.modalImages(o,i,e),!1))),!0})),this},t.modalImages=function(e,i,o){this.links=i,this.modal=new t.modal(null,o),this.showImage(e)},t.modalImages.prototype={params:{prev_txt:"previous",next_txt:"next",prev_img:"prev.png",next_img:"next.png",blank_img:"blank.gif"},showImage(e){const i=this;t(document).off("keypress.modalImage"),null==this.links[e]&&this.modal.removeOverlay();const o=this.links[e],{modal:s}=this,a=t("<div></div>");a.append(`<img src="${o.attr("href")}" alt="">`);const l=t("img:first",o);l.length>0&&l.attr("title")?a.append(`<span class="jq-modal-legend">${l.attr("title")}</span>`):o.attr("title")&&a.append(`<span class="jq-modal-legend">${o.attr("title")}</span>`),0!=e&&t('<a class="jq-modal-prev" href="#">prev</a>').appendTo(a),e+1<this.links.length&&t('<a class="jq-modal-next" href="#">next</a>').appendTo(a);const r=new Image;"visible"==this.modal.ctrl.box.css("visibility")?t("div.jq-modal-content",this.modal.ctrl.box).empty().append(this.modal.ctrl.loader):this.modal.updateBox(this.modal.ctrl.loader),r.onload=function(){s.updateBox(a,(function(){const o=t("div.jq-modal-content img",this.ctrl.box);i.navBtnStyle(t("a.jq-modal-next",this.ctrl.box),!0).css("height",o.height()).on("click",e+1,n),i.navBtnStyle(t("a.jq-modal-prev",this.ctrl.box),!1).css("height",o.height()).on("click",e-1,n),o.click((()=>{i.modal.removeOverlay()})),t(document).on("keypress.modalImage",d)})),this.onload=()=>{}},r.src=o.attr("href");var n=t=>(i.showImage(t.data),!1),d=t=>{const o=String.fromCharCode(t.which).toLowerCase();("n"==o||39==t.keyCode)&&e+1<i.links.length&&i.showImage(e+1),"p"!=o&&37!=t.keyCode||0==e||i.showImage(e-1)}},navBtnStyle(e,i){const o=`transparent url(${this.modal.params.blank_img}) repeat`,s=i?this.modal.params.next_img:this.modal.params.prev_img,a=i?"right":"left";return e.css("background",o).on("mouseenter",(function(){t(this).css("background",`transparent url(${s}) no-repeat center ${a}`).css("z-index",110)})).on("mouseleave",(function(){t(this).css("background",o)})),e}}})(),(()=>{const t=jQuery;t.modalWeb=(e,i,o)=>{const s=t(`<iframe src="${e}" frameborder="0">`).css({border:"none",width:i,height:o});return new t.modal(s)},t.fn.modalWeb=function(e,i){this.click((function(){return null!=this.href&&t.modalWeb(this.href,e,i),!1}))}})();
